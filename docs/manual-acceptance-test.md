# دليل اختبار القبول اليدوي - Inventory & Procurement

## الهدف
التحقق من صحة دورة الحياة الكاملة:
**PO → Stock → Order → Ship → Cancel → Return → Invoice → Profit**

---

## المتطلبات المسبقة
- [ ] تسجيل الدخول كمستخدم tenant
- [ ] وجود منتج واحد على الأقل في النظام

---

## خطوات الاختبار

### 1. إنشاء مورد
1. انتقل إلى `/purchasing`
2. اضغط "مورد جديد"
3. أدخل: اسم المورد، جهة الاتصال، البريد، الهاتف
4. اختر شروط الدفع (مثل: 30 يوم)
5. اضغط "إضافة المورد"
- **النتيجة المتوقعة**: يظهر المورد في قائمة الموردين ✓

### 2. إنشاء طلب شراء (PO)
1. في `/purchasing` > طلبات الشراء
2. اضغط "طلب شراء جديد"
3. اختر المورد
4. أضف منتج واحد على الأقل مع الكمية والسعر
5. حدد تاريخ التسليم المتوقع
6. اضغط "إنشاء طلب الشراء"
- **النتيجة المتوقعة**: يظهر PO بحالة "مسودة" ✓

### 3. استلام البضاعة
1. اضغط "استلام" على طلب الشراء
2. أدخل الكمية المستلمة
3. اضغط "تأكيد الاستلام"
- **النتيجة المتوقعة**: 
  - يتحول PO إلى "مستلم" ✓
  - يزداد المخزون في `/inventory` ✓
  - تظهر حركة "purchase" في سجل الحركات ✓

### 4. التحقق من المخزون
1. انتقل إلى `/inventory`
2. تحقق من أن المنتج يظهر الكمية الجديدة
3. اضغط على المنتج لعرض الحركات
- **النتيجة المتوقعة**: تظهر حركة الاستلام ✓

### 5. إنشاء طلب بيع
1. انتقل إلى `/orders`
2. أنشئ طلب جديد يحتوي على المنتج
3. أكد الطلب
- **النتيجة المتوقعة**:
  - يظهر عمود "المخزون" = "محجوز" ✓
  - ينخفض المخزون المتاح في `/inventory` ✓

### 6. شحن الطلب
1. غير حالة الطلب إلى "تم الشحن"
- **النتيجة المتوقعة**:
  - يظهر عمود "المخزون" = "مخصوم" ✓
  - تظهر حركة "out" في سجل الحركات ✓

### 7. إلغاء طلب (اختياري)
1. أنشئ طلب جديد وأكده
2. غير الحالة إلى "ملغي"
- **النتيجة المتوقعة**:
  - يعود المخزون المحجوز ✓
  - تظهر حركة "return" في السجل ✓

### 8. التحقق من COGS
1. في `/orders`، تحقق من عمود "COGS"
2. انتقل إلى `/profit`
3. تحقق من أن الطلب يظهر مع COGS صحيح
- **النتيجة المتوقعة**: COGS = cost × quantity ✓

### 9. التحقق من تنبيهات المخزون
1. في `/inventory`، تحقق من تبويب "التنبيهات"
2. إذا كان المخزون أقل من حد إعادة الطلب، يجب أن يظهر تنبيه
- **النتيجة المتوقعة**: تظهر التنبيهات بشكل صحيح ✓

---

## ملخص النتائج

| الخطوة | الحالة |
|--------|--------|
| إنشاء مورد | ☐ |
| إنشاء PO | ☐ |
| استلام البضاعة | ☐ |
| تحديث المخزون | ☐ |
| حجز المخزون عند الطلب | ☐ |
| خصم المخزون عند الشحن | ☐ |
| إرجاع المخزون عند الإلغاء | ☐ |
| حساب COGS | ☐ |
| تنبيهات المخزون | ☐ |

---

## ملاحظات
- جميع العمليات تسجل في سجل الحركات
- COGS يغذي Profit Intelligence تلقائياً
- التنبيهات تعمل عبر n8n workflows
